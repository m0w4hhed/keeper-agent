<ion-header>
  <ion-toolbar color="tertiary" mode="ios">
    <ion-buttons slot="start">
      <ion-back-button defaultHref="home"></ion-back-button>
    </ion-buttons>
    <ion-title>
      <strong>LIST</strong> AMBILAN
    </ion-title>
    <ion-buttons slot="end">
      <ion-button>
        <ion-icon name="calendar" slot="end"></ion-icon>
        <ion-datetime [(ngModel)]="now" (ionChange)="tampilkan()"
          display-format="DD" pickerFormat="DD MMM YYYY" [placeholder]="tanggal"
          style="font-size:15px;padding:0;margin:2px -5px 0;font-weight:bold;color:white"
        ></ion-datetime>
      </ion-button>
    </ion-buttons>
  </ion-toolbar>
  <ion-progress-bar color="tertiary" *ngIf="onload" type="indeterminate"></ion-progress-bar>
</ion-header>
 
<ion-content no-padding>

<div *ngIf="dataAmbilan">
  <ion-card *ngFor="let ambilan of dataAmbilan | groupBy:'cs' | orderBy:'key'; trackBy: addExpand">
    <ion-item-divider color="tertiary" (click)="ambilan.expand=!ambilan.expand">
      <ion-icon style="font-size: 18px;" slot="start" name="cube"></ion-icon>
      <ion-label><span class="eksp"><strong>{{ ambilan.key }}</strong> - <span style="color:var(--ion-color-success)">{{ hitung(ambilan.value).pcs | number }}</span>/{{ ambilan.value.length }}pcs</span></ion-label>
      <ion-note slot="end" class="pc">Rp.{{ hitung(ambilan.value).total | number }}</ion-note>
    </ion-item-divider>
    <ion-list *ngIf="ambilan.expand" class="ion-no-padding">
        <ion-item-sliding *ngFor="let data of ambilan.value | orderBy:'barang'">
          <ion-item [color]="data.status=='diambil'?'success':(data.status=='kosong'?'danger':(data.status=='fullkeep'?'warning':'light'))">
            <ion-label>
              <ion-note style="font-size: 12px;color: #383838">{{ data.penerima }} <strong>({{ data.cs }})</strong></ion-note>
              <ion-card-title style="font-size: 17px;">
              {{ data.barang }} {{ data.warna }}
              </ion-card-title>
            </ion-label>
            <ion-badge slot="end" color="light" style="border-radius: 10px;padding: 5px 10px">{{ data.status }}</ion-badge>
          </ion-item>
        </ion-item-sliding>
    </ion-list>
  </ion-card>
</div>

<!--
  <h1>Enter Value to Create QR code</h1>
  <ion-input type="text" [(ngModel)]="encodedData"></ion-input>
 
  <ion-button (click)="encodedText()">
    Create QR
  </ion-button>
-->
</ion-content>

<ion-footer>
  <ion-toolbar color="tertiary" *ngIf="dataAmbilan">
    <ion-chip slot="start">
      <ion-label color="light">Total | {{ dataAmbilan.length }}pcs</ion-label>
    </ion-chip>
    <ion-chip slot="end">
      <ion-label color="success">{{ hitung(dataAmbilan).total | number }} | {{ hitung(dataAmbilan).pcs }}pcs</ion-label>
    </ion-chip>
  </ion-toolbar>
</ion-footer>